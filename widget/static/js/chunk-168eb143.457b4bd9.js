(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-168eb143"],{5515:function(t,e,a){"use strict";var n,s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bgfff"},[a("div",[t._m(0),a("div",{staticClass:"search_warp"},[a("i",{staticClass:"icon_search"}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchValue,expression:"searchValue"}],staticClass:"search_input",attrs:{type:"text",placeholder:"请输入银行名称关键词"},domProps:{value:t.searchValue},on:{input:function(e){e.target.composing||(t.searchValue=e.target.value)}}})])]),a("div",{staticClass:"search_content"},[a("mt-index-list",{attrs:{height:312}},[t.searchValue?t._e():a("mt-index-section",{attrs:{index:""}},[a("li",[a("p",{staticClass:"line mint-indexsection-index"},[t._v("\n            热门银行\n          ")]),a("div",{staticClass:"hot_list"},t._l(t.bankHotListArr,function(e,n){return a("div",{key:n,staticClass:"box",attrs:{index:n}},[a("div",{staticClass:"search_item",on:{click:function(a){return t.clickCard(e)}}},[a("div",{staticClass:"text"},[t._v("\n                  "+t._s(e.name)+"\n                ")])])])}),0)])]),t._l(t.bankListArr,function(e,n){return a("mt-index-section",{key:n,attrs:{index:n}},t._l(e,function(e,n){return a("li",{key:n,staticClass:"search_item",on:{click:function(a){return t.clickCard(e)}}},[t._v("\n          "+t._s(e.name)+"\n        ")])}),0)})],2)],1)])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search_title"},[a("h5",{staticClass:"size36 color333"},[t._v("\n        选择银行\n      ")])])}],r=(a("456d"),a("55dd"),a("ac6a"),a("bd86")),c=(a("7f7f"),a("76a0")),o=(a("8635"),a("f1a6"),{name:"SelectCard",components:(n={},Object(r["a"])(n,c["IndexList"].name,c["IndexList"]),Object(r["a"])(n,c["IndexSection"].name,c["IndexSection"]),n),data:function(){return{bankListArr:{},bankHotListArr:{},searchValue:"",resultsList:""}},computed:{bankList:function(){return this.$store.state.bankList}},watch:{searchValue:function(t,e){var a=String(t).toUpperCase(),n=[];this.resultsList.forEach(function(t){-1===String(t.name).indexOf(a)&&-1===String(t.first_pinyin_letter).indexOf(a)||n.push(t)}),this.bankListArr=n.reduce(function(t,e){return t[e.first_pinyin_letter[0]]||(t[e.first_pinyin_letter[0]]=[]),t[e.first_pinyin_letter[0]].push(e),t},{}),this.bankListArr=this.objKeySort(this.bankListArr)}},created:function(){this.getBankListFun()},methods:{thisTitle:function(){document.title="选择银行卡"},getBankListFun:function(){var t=this;t.$api.card.getBankList().then(function(e){t.resultsList=e.data.data.bank_list,t.bankHotListArr=e.data.data.hot_bank_list,console.log(t.resultsList),t.bankListArr=t.resultsList.reduce(function(t,e){return console.log(t),console.log(e),t[e.first_pinyin_letter[0]]||(t[e.first_pinyin_letter[0]]=[]),t[e.first_pinyin_letter[0]].push(e),t},{}),t.bankListArr=t.objKeySort(t.bankListArr)})},objKeySort:function(t){console.log(t);var e=Object.keys(t).sort();console.log(e);for(var a={},n=0;n<e.length;n++)a[e[n]]=t[e[n]];return a},clickCard:function(t){this.$emit("selectCard",t)}}}),l=o,d=(a("9b87"),a("2877")),u=Object(d["a"])(l,s,i,!1,null,"2cfd1e14",null);e["a"]=u.exports},"826b":function(t,e,a){},"9b87":function(t,e,a){"use strict";var n=a("826b"),s=a.n(n);s.a},a86c:function(t,e,a){"use strict";a.r(e);var n,s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",["add"===t.status||t.fromSelectCardPage?a("top-msg",{attrs:{"header-name":"添加借记卡"}}):t._e(),"edit"===t.status?a("top-msg",{attrs:{"header-name":"编辑借记卡"}}):t._e(),a("div",{staticClass:"con_body"},[a("div",{staticClass:"form_cells form_cells_form bgfff"},[a("div",{staticClass:"form_cell"},[t._m(0),a("div",{staticClass:"form_cellBd"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.cardNoShow,expression:"cardNoShow"}],ref:"cardInput",class:["form_input",t.cardNoShow?"bold":""],attrs:{placeholder:"请输入您的借记卡号"},domProps:{value:t.cardNoShow},on:{keyup:t.showNum,blur:t.chargeNum,input:function(e){e.target.composing||(t.cardNoShow=e.target.value)}}})])]),a("div",{staticClass:"form_cell"},[t._m(1),a("div",{staticClass:"form_cellBd",on:{click:function(e){t.bankPicker=!0}}},[t.bankSelect.name?a("span",{staticClass:"size30"},[t._v(t._s(t.bankSelect.name))]):a("span",{staticClass:"size30",staticStyle:{color:"#BEBEBE"}},[t._v("请选择所属银行")])])]),a("div",{staticClass:"form_cell"},[t._m(2),a("div",{staticClass:"form_cellBd"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.tel,expression:"tel"}],staticClass:"form_input",attrs:{type:"number",placeholder:"请输入预留手机号"},domProps:{value:t.tel},on:{input:function(e){e.target.composing||(t.tel=e.target.value)}}})])])]),"add"===t.status||t.fromSelectCardPage?a("div",{class:[t.fromSelectCardPage?"btn-add":"btn_warp"]},[a("button",{staticClass:"btn btn_add",on:{click:t.addCardFun}},[t._v("\n        "+t._s(t.fromSelectCardPage?"确认添加":"保  存")+"\n      ")])]):"edit"===t.status?a("div",{staticClass:"btn_warp"},[a("button",{staticClass:"btn btn_add",on:{click:t.editCardFUn}},[t._v("\n        保  存\n      ")])]):t._e()]),a("van-popup",{attrs:{position:"bottom"},model:{value:t.bankPicker,callback:function(e){t.bankPicker=e},expression:"bankPicker"}},[a("choose-card",{on:{selectCard:t.selectCard}})],1)],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form_cellHd"},[a("label",{staticClass:"form_label"},[t._v("借记卡号")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form_cellHd"},[a("label",{staticClass:"form_label"},[t._v("所属银行")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form_cellHd"},[a("label",{staticClass:"form_label"},[t._v("预留手机号")])])}],r=(a("a481"),a("bd86")),c=(a("7f7f"),a("5f5f"),a("f253")),o=a("2c92"),l=(a("5b4d"),a("5515")),d={name:"AddCard",components:(n={topMsg:o["a"]},Object(r["a"])(n,c["a"].name,c["a"]),Object(r["a"])(n,"chooseCard",l["a"]),n),props:["fromSelectCardPage","hideAddCard"],data:function(){return{status:this.$util.getQueryVariable("status"),cardUser:"",cardNo:"",cardNoShow:"",tel:"",code:"",isGetCode:!1,num:60,timer:"",cardId:this.$util.getQueryVariable("cardId"),bankNo:"",bankSelect:{},bankPicker:!1,bankListArr:[]}},computed:{token:function(){return this.$store.state.token},bankList:function(){return this.$store.state.bankList}},created:function(){this.thisTitle(),this.getBankListFun(),"edit"===this.status&&this.getCardMsg()},methods:{thisTitle:function(){"add"===this.static?document.title="添加借记卡":document.title=this.fromSelectCardPage?"添加借记卡":"编辑借记卡"},getCodeFun:function(){var t=this,e=function(e){return t.$dialog({title:e,showCancelButton:!1,confirmButtonText:"确定",cancelButtonText:"确定",className:"dialog",closeOnClickOverlay:!0})};t.tel?t.$util.isPhone(t.tel)?t.isGetCode||(t.isGetCode=!0,t.timer=setInterval(function(){0!==t.num?t.num--:(t.isGetCode=!1,t.num=60,clearInterval(t.timer))},1e3)):e("请输入正确的手机号码"):e("请输入您的手机号码")},addCardFun:function(){var t=this,e=this,a=function(t){return e.$dialog({title:t,showCancelButton:!1,confirmButtonText:"确定",className:"dialog",closeOnClickOverlay:!0})};if(e.cardNo)if(e.bankSelect)if(e.tel){var n={bank_no:e.bankSelect.bank_no,card_no:e.cardNo,card_phone_number:e.tel};e.$api.card.bindCard("DEBIT",n).then(function(n){t.fromSelectCardPage?(t.hideAddCard(),t.$emit("toReflesh")):a("添加借记卡成功").then(function(t){e.$router.go(-1)})}).catch(function(t){console.log(t)})}else a("请输入预留手机号码");else a("请输入所属银行");else a("请输入借记卡号")},getCardMsg:function(){var t=this;t.$api.card.getCard("DEBIT",this.cardId).then(function(e){e=e.data,t.cardNo=e.data.card_no,t.cardNoShow=t.cardNo.replace(/\s/g,"").replace(/(\d{4})(?=\d)/g,"$1 "),t.$set(t.bankSelect,"name",e.data.bank_info.name),t.$set(t.bankSelect,"bank_no",e.data.bank_info.bank_no),t.tel=e.data.card_phone_number})},editCardFUn:function(){var t=this,e=function(e){return t.$dialog({title:e,showCancelButton:!1,confirmButtonText:"确定",className:"dialog",closeOnClickOverlay:!0})};if(t.cardNo)if(t.bankSelect)if(t.tel){var a={bank_no:t.bankSelect.bank_no,card_no:t.cardNo,card_phone_number:t.tel};t.$api.card.editCard(t.cardId,"DEBIT",a).then(function(a){e("编辑借记卡成功").then(function(e){t.$router.go(-1)})})}else e("请输入预留手机号码");else e("请输入所属银行");else e("请输入借记卡号")},closeStatusPicker:function(t){console.log(t),this.bankSelect=t,this.bankPicker=!1},getBankListFun:function(){var t=this;t.$store.dispatch("GetBankList").then(function(){for(var e in t.bankList)t.bankListArr.push({bankNo:e,text:t.bankList[e]})})},selectCard:function(t){this.bankSelect=t,this.bankPicker=!1},showNum:function(){var t=this.$refs.cardInput;t.selectionStart<this.cardNoShow.length||(this.cardNoShow=this.cardNoShow.replace(/\s/g,"").replace(/(\d{4})(?=\d)/g,"$1 "),this.cardNo=this.cardNoShow.replace(/\s/g,""))},chargeNum:function(){this.cardNoShow=this.cardNoShow.replace(/\s/g,"").replace(/(\d{4})(?=\d)/g,"$1 "),this.cardNo=this.cardNoShow.replace(/\s/g,"")}}},u=d,f=(a("d8f7"),a("2877")),h=Object(f["a"])(u,s,i,!1,null,"493238d7",null);e["default"]=h.exports},d8f7:function(t,e,a){"use strict";var n=a("e6c5"),s=a.n(n);s.a},e6c5:function(t,e,a){}}]);